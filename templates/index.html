{% extends "base.html" %}

{% block title %}OBO Community Health{% endblock %}

{% block scripts %}
{{ super() }}
<script>
    $(document).ready(function () {
        $("#table-ontologies").DataTable({
            "order": [[8, "desc"]],
            "scrollX": true
        });
    })
</script>
{% endblock %}

{% block content %}
<div class="container">
    <h1 align="center">OBO Community Health</h1>
    <p>
        This page gives insight into which OBO Foundry ontologies are actively being updated and feedback
        given to users. It was generated using the GitHub API with scripts at
        <a href="https://github.com/cthoyt/obo-community-health">https://github.com/cthoyt/obo-community-health</a>.
    </p>

    <table class="table table-striped table-hover" id="table-ontologies">
        <thead>
        <tr style="text-align: right;">
            <th>ID</th>
            <th>Name</th>
            <th>GitHub</th>
            <th>Stars</th>
            <th>Open Issues</th>
            <th>OBO Topic</th>
            <th>ODK Config</th>
            <th>Recently Pushed</th>
            <th>Recently Interacted</th>
            <th>Last Year Total Contributions</th>
            <th>Last Year Unique Contributors</th>
            <th>Last Year Top Contributor</th>
            <th>Lifetime Total Contributions</th>
            <th>Lifetime Unique Contributors</th>
            <th>Lifetime Top Contributor</th>
            <th>License</th>
        </tr>
        </thead>
        <tbody>
        {% for row in rows %}
        <tr>
            <td>
                <a href="http://www.obofoundry.org/ontology/{{ row.prefix }}">
                    {{ row.prefix }}
                </a>
            </td>
            <td>{{ row.title }}</td>
            {% if row.owner %}
            <td>
                <a href="https://github.com/{{ row.owner }}/{{ row.repo }}">
                    Yes
                </a>
            </td>
            <td align="right">{{ row.stars }}</td>
            <td align="right">{{ row.open_issues }}</td>
            <td>{{ row.has_obofoundry_topic }}</td>
            <td>{{ row.has_odk }}</td>
            <td>{% if row.pushed_at %}{{ row.pushed_at.strftime("%Y-%m-%d") }}{% endif %}</td>
            <td>{% if row.most_recent_datetime %}{{ row.most_recent_datetime.strftime("%Y-%m-%d") }}{% endif %}</td>
            {% if row.last_year_total_contributions > 0 %}
            <td align="right">{{ row.last_year_total_contributions }}</td>
            <td align="right">{{ row.last_year_unique_contributors }}</td>
            <td>
                <a href="https://github.com/{{ row.top_last_year_contributor }}">@{{ row.top_last_year_contributor
                    }}</a>
                ({{ row.top_last_year_contributions }})
            </td>
            {% else %}
            <td></td>
            <td></td>
            <td></td>
            {% endif %}
            {% if row.lifetime_total_contributions %}
            <td align="right">{{ row.lifetime_total_contributions }}</td>
            <td align="right">{{ row.lifetime_unique_contributors }}</td>
            <td>
                <a href="https://github.com/{{ row.top_lifetime_contributor }}">@{{ row.top_lifetime_contributor }}</a>
                ({{ row.top_lifetime_contributions }})
            </td>
            {% else %}
            <td></td>
            <td></td>
            <td></td>
            {% endif %}
            <td>{% if row.license %}{{ row.license }}{% endif %}</td>
            {% else %}
            <td>No</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            {% endif %}
        </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
